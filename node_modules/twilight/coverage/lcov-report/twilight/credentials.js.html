<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for twilight/credentials.js</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">twilight/</a> credentials.js
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">88.24% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>15/17</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">37.5% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>3/8</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>3/3</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">93.75% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>15/16</span>
      </div>
    </div>
  </div>
  <div class='status-line high'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">'use strict';
&nbsp;
var streaming_1 = require('streaming');
var sv_1 = require('sv');
var fs_1 = require('fs');
/**
Read accounts from tab/comma-separated values in `filepath`, which
should have the headers: consumer_key, consumer_secret, token, token_secret,
choose one at random, and use that.
*/
function getOAuthFromFile(filepath, callback) {
    var parser = fs_1.createReadStream(filepath, { encoding: 'utf8' }).pipe(new sv_1.Parser());
    streaming_1.readToEnd(parser, function (error, accounts) {
        <span class="missing-if-branch" title="if path not taken" >I</span>if (error) <span class="cstat-no" title="statement not covered" >return callback(error);</span>
        var _a = accounts[Math.random() * accounts.length | 0],
            consumer_key = _a.consumer_key,
            consumer_secret = _a.consumer_secret,
            token = _a.token,
            token_secret = _a.token_secret;
        callback(null, { consumer_key: consumer_key, consumer_secret: consumer_secret, token: token, token_secret: token_secret });
    });
}
/**
Try to get read OAuth credentials from the environment (since in testing we
might want to specify all oauth credentials via the environment), and,
failing that, from ~/.twitter.
*/
function getOAuth(callback) {
    var _a = process.env,
        consumer_key = _a.consumer_key,
        consumer_secret = _a.consumer_secret,
        token = _a.token,
        token_secret = _a.token_secret;
    <span class="missing-if-branch" title="if path not taken" >I</span>if (consumer_key &amp;&amp; <span class="branch-1 cbranch-no" title="branch not covered" >consumer_secret </span>&amp;&amp; <span class="branch-2 cbranch-no" title="branch not covered" >token </span>&amp;&amp; <span class="branch-3 cbranch-no" title="branch not covered" >token_secret)</span> {
<span class="cstat-no" title="statement not covered" >        callback(null, { consumer_key: consumer_key, consumer_secret: consumer_secret, token: token, token_secret: token_secret });</span>
    } else {
        // otherwise (in the normal case) get oauth account info from file
        var defaultFilepath = process.env.HOME + "/.twitter";
        getOAuthFromFile(defaultFilepath, callback);
    }
}
exports.getOAuth = getOAuth;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9jaGJyb3duL2dpdGh1Yi90d2lsaWdodC9jcmVkZW50aWFscy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLElBQUksV0FBVyxHQUFHLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUN2QyxJQUFJLElBQUksR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDekIsSUFBSSxJQUFJLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDOzs7Ozs7QUFNekIsU0FBUyxnQkFBZ0IsQ0FBQyxRQUFRLEVBQUUsUUFBUSxFQUFFO0FBQzFDLFFBQUksTUFBTSxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxRQUFRLEVBQUUsRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQztBQUMzRixlQUFXLENBQUMsU0FBUyxDQUFDLE1BQU0sRUFBRSxVQUFVLEtBQUssRUFBRSxRQUFRLEVBQUU7QUFDckQsWUFBSSxLQUFLLEVBQ0wsT0FBTyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDM0IsWUFBSSxFQUFFLEdBQUcsUUFBUSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxRQUFRLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztZQUFFLFlBQVksR0FBRyxFQUFFLENBQUMsWUFBWTtZQUFFLGVBQWUsR0FBRyxFQUFFLENBQUMsZUFBZTtZQUFFLEtBQUssR0FBRyxFQUFFLENBQUMsS0FBSztZQUFFLFlBQVksR0FBRyxFQUFFLENBQUMsWUFBWSxDQUFDO0FBQy9LLGdCQUFRLENBQUMsSUFBSSxFQUFFLEVBQUUsWUFBWSxFQUFFLFlBQVksRUFBRSxlQUFlLEVBQUUsZUFBZSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsWUFBWSxFQUFFLFlBQVksRUFBRSxDQUFDLENBQUM7S0FDOUgsQ0FBQyxDQUFDO0NBQ047Ozs7OztBQU1ELFNBQVMsUUFBUSxDQUFDLFFBQVEsRUFBRTtBQUN4QixRQUFJLEVBQUUsR0FBRyxPQUFPLENBQUMsR0FBRztRQUFFLFlBQVksR0FBRyxFQUFFLENBQUMsWUFBWTtRQUFFLGVBQWUsR0FBRyxFQUFFLENBQUMsZUFBZTtRQUFFLEtBQUssR0FBRyxFQUFFLENBQUMsS0FBSztRQUFFLFlBQVksR0FBRyxFQUFFLENBQUMsWUFBWSxDQUFDO0FBQzdJLFFBQUksWUFBWSxJQUFJLGVBQWUsSUFBSSxLQUFLLElBQUksWUFBWSxFQUFFO0FBQzFELGdCQUFRLENBQUMsSUFBSSxFQUFFLEVBQUUsWUFBWSxFQUFFLFlBQVksRUFBRSxlQUFlLEVBQUUsZUFBZSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsWUFBWSxFQUFFLFlBQVksRUFBRSxDQUFDLENBQUM7S0FDOUgsTUFDSTs7QUFFRCxZQUFJLGVBQWUsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksR0FBRyxXQUFXLENBQUM7QUFDckQsd0JBQWdCLENBQUMsZUFBZSxFQUFFLFFBQVEsQ0FBQyxDQUFDO0tBQy9DO0NBQ0o7QUFDRCxPQUFPLENBQUMsUUFBUSxHQUFHLFFBQVEsQ0FBQyIsImZpbGUiOiIvVXNlcnMvY2hicm93bi9naXRodWIvdHdpbGlnaHQvY3JlZGVudGlhbHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgc3RyZWFtaW5nXzEgPSByZXF1aXJlKCdzdHJlYW1pbmcnKTtcbnZhciBzdl8xID0gcmVxdWlyZSgnc3YnKTtcbnZhciBmc18xID0gcmVxdWlyZSgnZnMnKTtcbi8qKlxuUmVhZCBhY2NvdW50cyBmcm9tIHRhYi9jb21tYS1zZXBhcmF0ZWQgdmFsdWVzIGluIGBmaWxlcGF0aGAsIHdoaWNoXG5zaG91bGQgaGF2ZSB0aGUgaGVhZGVyczogY29uc3VtZXJfa2V5LCBjb25zdW1lcl9zZWNyZXQsIHRva2VuLCB0b2tlbl9zZWNyZXQsXG5jaG9vc2Ugb25lIGF0IHJhbmRvbSwgYW5kIHVzZSB0aGF0LlxuKi9cbmZ1bmN0aW9uIGdldE9BdXRoRnJvbUZpbGUoZmlsZXBhdGgsIGNhbGxiYWNrKSB7XG4gICAgdmFyIHBhcnNlciA9IGZzXzEuY3JlYXRlUmVhZFN0cmVhbShmaWxlcGF0aCwgeyBlbmNvZGluZzogJ3V0ZjgnIH0pLnBpcGUobmV3IHN2XzEuUGFyc2VyKCkpO1xuICAgIHN0cmVhbWluZ18xLnJlYWRUb0VuZChwYXJzZXIsIGZ1bmN0aW9uIChlcnJvciwgYWNjb3VudHMpIHtcbiAgICAgICAgaWYgKGVycm9yKVxuICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKGVycm9yKTtcbiAgICAgICAgdmFyIF9hID0gYWNjb3VudHNbTWF0aC5yYW5kb20oKSAqIGFjY291bnRzLmxlbmd0aCB8IDBdLCBjb25zdW1lcl9rZXkgPSBfYS5jb25zdW1lcl9rZXksIGNvbnN1bWVyX3NlY3JldCA9IF9hLmNvbnN1bWVyX3NlY3JldCwgdG9rZW4gPSBfYS50b2tlbiwgdG9rZW5fc2VjcmV0ID0gX2EudG9rZW5fc2VjcmV0O1xuICAgICAgICBjYWxsYmFjayhudWxsLCB7IGNvbnN1bWVyX2tleTogY29uc3VtZXJfa2V5LCBjb25zdW1lcl9zZWNyZXQ6IGNvbnN1bWVyX3NlY3JldCwgdG9rZW46IHRva2VuLCB0b2tlbl9zZWNyZXQ6IHRva2VuX3NlY3JldCB9KTtcbiAgICB9KTtcbn1cbi8qKlxuVHJ5IHRvIGdldCByZWFkIE9BdXRoIGNyZWRlbnRpYWxzIGZyb20gdGhlIGVudmlyb25tZW50IChzaW5jZSBpbiB0ZXN0aW5nIHdlXG5taWdodCB3YW50IHRvIHNwZWNpZnkgYWxsIG9hdXRoIGNyZWRlbnRpYWxzIHZpYSB0aGUgZW52aXJvbm1lbnQpLCBhbmQsXG5mYWlsaW5nIHRoYXQsIGZyb20gfi8udHdpdHRlci5cbiovXG5mdW5jdGlvbiBnZXRPQXV0aChjYWxsYmFjaykge1xuICAgIHZhciBfYSA9IHByb2Nlc3MuZW52LCBjb25zdW1lcl9rZXkgPSBfYS5jb25zdW1lcl9rZXksIGNvbnN1bWVyX3NlY3JldCA9IF9hLmNvbnN1bWVyX3NlY3JldCwgdG9rZW4gPSBfYS50b2tlbiwgdG9rZW5fc2VjcmV0ID0gX2EudG9rZW5fc2VjcmV0O1xuICAgIGlmIChjb25zdW1lcl9rZXkgJiYgY29uc3VtZXJfc2VjcmV0ICYmIHRva2VuICYmIHRva2VuX3NlY3JldCkge1xuICAgICAgICBjYWxsYmFjayhudWxsLCB7IGNvbnN1bWVyX2tleTogY29uc3VtZXJfa2V5LCBjb25zdW1lcl9zZWNyZXQ6IGNvbnN1bWVyX3NlY3JldCwgdG9rZW46IHRva2VuLCB0b2tlbl9zZWNyZXQ6IHRva2VuX3NlY3JldCB9KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIC8vIG90aGVyd2lzZSAoaW4gdGhlIG5vcm1hbCBjYXNlKSBnZXQgb2F1dGggYWNjb3VudCBpbmZvIGZyb20gZmlsZVxuICAgICAgICB2YXIgZGVmYXVsdEZpbGVwYXRoID0gcHJvY2Vzcy5lbnYuSE9NRSArIFwiLy50d2l0dGVyXCI7XG4gICAgICAgIGdldE9BdXRoRnJvbUZpbGUoZGVmYXVsdEZpbGVwYXRoLCBjYWxsYmFjayk7XG4gICAgfVxufVxuZXhwb3J0cy5nZXRPQXV0aCA9IGdldE9BdXRoO1xuIl19</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Sun Dec 20 2015 17:11:32 GMT-0600 (CST)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
